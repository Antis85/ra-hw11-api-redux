(this["webpackJsonpra-hw11-api-redux"]=this["webpackJsonpra-hw11-api-redux"]||[]).push([[0],{27:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r(9),a=r.n(c),i=r(7),s=r(3),o=r(2),l=r(4),u="REMOVE_SERVICE",j="CHANGE_ADD_FIELD",b="CHANGE_EDIT_FIELD",d="FILTER_SERVICE",O="CHANGE_FILTER_FIELD",h="CLEAR_FORM",v="CLEAR_FILTER",p="FETCH_SERVICES_REQUEST",f="FETCH_SERVICES_SUCCESS",m="FETCH_SERVICES_FAILED",E="ADD_SERVICES_REQUEST",g="ADD_SERVICES_SUCCESS",x="ADD_SERVICES_FAILED",_="EDIT_SERVICES_REQUEST",S="EDIT_SERVICES_SUCCESS",y="EDIT_SERVICES_FAILED";function C(){return{type:h}}function F(e){return{type:m,payload:{error:e}}}function I(){return{type:_}}function w(e){return{type:S,payload:{item:e}}}function D(e){return{type:y,payload:{error:e}}}var R=r.p+"static/media/mcru-ajax-loader.6f9ac78c.gif",T=r(1);function L(){return Object(T.jsx)("div",{className:"loader",children:Object(T.jsx)("img",{src:R,alt:"LOADING..."})})}var N="https://antis-ra-hw-thunk.herokuapp.com/api/services";function A(){var e=Object(l.c)((function(e){return e.serviceEdit})),t=e.item,r=e.loading,c=e.error,a=Object(s.g)(),i=Object(s.h)(),u=Object(l.b)();Object(n.useEffect)((function(){!function(e,t){e(I()),fetch(N+"/"+t).then((function(e){if(e.status<200||e.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");return e.json()})).then((function(t){e(w(t))})).catch((function(t){console.log("fetchServices_Get_Error_text: ",t.message),e(D(t.message))}))}(u,i.id)}),[u,i.id]);var j=function(e){var t=e.target,r=t.name,n=t.value;u(function(e,t){return{type:b,payload:{name:e,value:t}}}(r,n))};return r&&Object(T.jsx)(L,{})||c||Object(T.jsxs)("form",{onSubmit:function(e){e.preventDefault(),!t.name||!t.price||t.price<=0||(u(I()),function(e,t,r){console.log("fetchPostEditServices_item: ",e),fetch(N,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(Object(o.a)({},e))}).then((function(e){if(console.log(e),e.ok||console.log("ServiceForm_handleSubmit_fetchServices_result.statusText:",e.status,e.statusText),e.status<200||e.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");t(w()),r("/")})).catch((function(e){console.log("ServiceForm_handleSubmit_fetchServices_Error_text: ",e.message),t(D(e.message))}))}(Object(o.a)({},t),u,a))},onReset:function(e){u(C()),a("/")},children:[Object(T.jsx)("h3",{children:"Edit service:"}),Object(T.jsxs)("label",{children:["Name ",Object(T.jsx)("input",{name:"name",onChange:j,value:t.name})]}),Object(T.jsxs)("label",{children:["Price",Object(T.jsx)("input",{name:"price",type:"number",onChange:j,value:t.price})]}),Object(T.jsxs)("label",{children:["Content",Object(T.jsx)("input",{name:"content",onChange:j,value:t.content})]}),Object(T.jsx)("button",{type:"submit",disabled:r||!t.name||!t.price||t.price<=0,children:"Save"}),Object(T.jsx)("button",{type:"reset",disabled:r,children:"Close"}),Object(T.jsx)("div",{children:c})]})}var V=function(e,t){return console.log("fetchServices_item: ",t),e({type:E}),fetch("https://antis-ra-hw-thunk.herokuapp.com/api/services",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(Object(o.a)(Object(o.a)({},t),{},{id:0}))}).then((function(t){if(console.log(t),t.ok||console.log("ServiceForm_handleSubmit_fetchServices_result:",t.status,t.statusText),t.status<200||t.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");e({type:g}),G(e)})).catch((function(t){var r;console.log("ServiceForm_handleSubmit_fetchServices_Error_text: ",t.message),e((r=t.message,{type:x,payload:{error:r}}))}))};function k(){var e=Object(l.c)((function(e){return e.serviceAdd})),t=e.item,r=e.loading,n=e.error,c=Object(l.b)(),a=function(e){var t=e.target,r=t.name,n=t.value;c(function(e,t){return{type:j,payload:{name:e,value:t}}}(r,n))};return Object(T.jsxs)("form",{onSubmit:function(e){e.preventDefault(),!t.name||!t.price||t.price<=0||V(c,Object(o.a)(Object(o.a)({},t),{},{id:0}))},onReset:function(e){c(C())},children:[Object(T.jsx)("h3",{children:"Add service:"}),Object(T.jsxs)("label",{children:["Name ",Object(T.jsx)("input",{name:"name",onChange:a,value:t.name})]}),Object(T.jsxs)("label",{children:["Price",Object(T.jsx)("input",{name:"price",type:"number",onChange:a,value:t.price})]}),Object(T.jsx)("button",{type:"submit",disabled:r||!t.name||!t.price||t.price<=0,children:"Save"}),Object(T.jsx)("button",{type:"reset",disabled:r,children:"Cancel"}),Object(T.jsx)("div",{children:n})]})}function U(){var e=Object(l.c)((function(e){return e.serviceFilter})).filter,t=Object(l.c)((function(e){return e.serviceList})).activeFilter,r=Object(l.b)();return Object(T.jsx)("label",{children:Object(T.jsxs)("form",{onSubmit:function(t){t.preventDefault(),r({type:d,payload:{setFilter:e}})},onReset:function(){r({type:v})},children:[Object(T.jsx)("h3",{children:"Filter services:"}),Object(T.jsxs)("div",{children:["Active filter: ",t?'"'.concat(t,'"'):"NO"]}),Object(T.jsx)("input",{name:"filter",onChange:function(e){var t=e.target.value;r(function(e){return{type:O,payload:{filter:e}}}(t))},value:e}),Object(T.jsx)("button",{type:"submit",children:"Set"}),Object(T.jsx)("button",{type:"reset",children:"Clear"})]})})}var H="https://antis-ra-hw-thunk.herokuapp.com/api/services",G=function(e){return e({type:p}),fetch(H).then((function(e){if(e.status<200||e.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");return e.json()})).then((function(t){e({type:f,payload:{services:t}})})).catch((function(t){e(F(t.message))}))},P=function(e,t){return e(function(e){return{type:u,payload:{id:e}}}(t)),fetch(H+"/"+t,{method:"DELETE"}).then((function(t){if(t.status<200||t.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");G(e)})).catch((function(t){e(F(t.message))}))};function J(){var e=Object(l.c)((function(e){return e.serviceList})),t=e.services,r=e.activeFilter,c=e.loading,a=e.error,i=Object(s.g)(),o=Object(l.b)();Object(n.useEffect)((function(){G(o)}),[o]);var u=t.filter((function(e){return e.name.toLowerCase().includes(r.toLowerCase())})),j=(u.length?u:t).map((function(e){return Object(T.jsxs)("li",{children:[e.name," ",e.price,Object(T.jsx)("button",{disabled:e.loading,onClick:function(){var t;(t=e.id)&&i("/services/"+t)},children:"\u270e"}),Object(T.jsx)("button",{disabled:e.loading,onClick:function(){return t=e.id,void P(o,t);var t},children:"\u2715"})]},e.id)}));return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(k,{}),Object(T.jsx)(U,{}),c&&Object(T.jsx)(L,{})||a||Object(T.jsx)("ul",{children:!u.length&&r?"Nothing to display. Try another filter string!":j})]})}function X(){return Object(T.jsxs)("div",{className:"page-404",children:[Object(T.jsx)("div",{className:"page-404__header",children:"404"}),Object(T.jsx)("div",{className:"page-404__main",children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430..."}),Object(T.jsx)(i.b,{to:"/",children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"})]})}r(26);function Q(){return Object(T.jsx)(i.a,{children:Object(T.jsx)("div",{className:"page",children:Object(T.jsxs)(s.d,{children:[Object(T.jsx)(s.b,{path:"/services/:id",element:Object(T.jsx)(A,{})}),Object(T.jsx)(s.b,{path:"/services",element:Object(T.jsx)(J,{})}),Object(T.jsx)(s.b,{path:"/",element:Object(T.jsx)(s.a,{to:"/services"})}),Object(T.jsx)(s.b,{path:"*",element:Object(T.jsx)(X,{})})]})})})}var M=r(13),B={services:[],activeFilter:"",loading:!1,error:null};var q=r(8),z={item:{name:"",price:""},loading:!1,error:null};var K={item:{id:"",name:"",price:"",content:""},loading:!1,error:null};var W={filter:""};var Y=Object(M.a)({serviceList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(o.a)(Object(o.a)({},e),{},{loading:!0,error:null});case f:var r=t.payload.services;return Object(o.a)(Object(o.a)({},e),{},{loading:!1,services:r});case m:var n=t.payload.error;return Object(o.a)(Object(o.a)({},e),{},{loading:!1,error:n});case u:var c=t.payload.id,a=e.services.find((function(e){return e.id===c}));return a&&(a.loading=!0),Object(o.a)({},e);case d:var i=t.payload.setFilter;return Object(o.a)(Object(o.a)({},e),{},{activeFilter:i});case v:return Object(o.a)(Object(o.a)({},e),{},{activeFilter:B.activeFilter});default:return e}},serviceAdd:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:var r=t.payload,n=r.name,c=r.value;return Object(o.a)(Object(o.a)({},e),{},{item:Object(o.a)(Object(o.a)({},e.item),{},Object(q.a)({},n,c))});case h:return Object(o.a)(Object(o.a)({},e),{},{item:z.item});case g:return Object(o.a)({},z);case E:return Object(o.a)(Object(o.a)({},e),{},{loading:!0,error:null});case x:var a=t.payload.error;return Object(o.a)(Object(o.a)({},e),{},{loading:!1,error:a});default:return e}},serviceEdit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:var r=t.payload,n=r.name,c=r.value;return Object(o.a)(Object(o.a)({},e),{},{item:Object(o.a)(Object(o.a)({},e.item),{},Object(q.a)({},n,c))});case h:return Object(o.a)(Object(o.a)({},e),{},{item:K.item});case S:var a=t.payload.item;return a?Object(o.a)(Object(o.a)({},e),{},{loading:!1,item:a}):Object(o.a)({},K);case _:return Object(o.a)(Object(o.a)({},e),{},{loading:!0,error:null});case y:var i=t.payload.error;return Object(o.a)(Object(o.a)({},e),{},{loading:!1,error:i});default:return e}},serviceFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:var r=t.payload.filter;return Object(o.a)(Object(o.a)({},e),{},{filter:r});case v:return Object(o.a)({},W);default:return e}}}),Z=Object(M.b)(Y,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());a.a.render(Object(T.jsx)(l.a,{store:Z,children:Object(T.jsx)(Q,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.926af3e2.chunk.js.map